:root{
  --a4-w:210mm;
  --a4-h:297mm;
  --gutter:12mm;
  --header-h:22mm;
  --footer-h:22mm;
  --content-h: calc(var(--a4-h) - var(--header-h) - var(--footer-h));
  --font: "Segoe UI", Roboto, Arial, sans-serif;
}

*{box-sizing:border-box}
body{font-family:var(--font); background:#efefef; margin:14px; color:#111}
.topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.topbar .title{font-weight:700}
.preview-actions button{padding:8px 12px;border-radius:6px;border:0;background:#007bff;color:#fff;cursor:pointer}

/* visual wrapper so pages show side-by-side if space allows */
.preview-wrap{display:flex;flex-wrap:wrap;gap:12px}

/* A4 page */
.a4page{
  width:var(--a4-w);
  height:var(--a4-h);
  background:#fff;
  box-shadow:0 6px 18px rgba(0,0,0,0.12);
  overflow:hidden;
  position:relative;
  border:1px solid #e8e8e8;
  margin:0;
}

/* header & footer */
.header{
  height:var(--header-h);
  padding:4mm var(--gutter);
  display:flex;
  align-items:center;
  justify-content:center;
  border-bottom:0;
}

/* New header image styling */
.header .header-image{
  width:100%;
  height:auto;
  object-fit:contain;
  display:block;
}

/* Legacy support for old header structure (if any remains) */
.header .left{display:flex;align-items:center;gap:8px}
.header img.logo-small{width:30mm;height:auto;display:block}
.header .center{flex:1;text-align:center;font-weight:700}
.header .right{font-size:11px;line-height:1.2;text-align:right;color:#333}

/* content area between header & footer */
.content{
  padding:8mm var(--gutter);
  height:var(--content-h);
  overflow:hidden;
}

/* footer */
.footer{
  height:var(--footer-h);
  padding:4mm var(--gutter);
  display:flex;
  flex-direction:column;
  justify-content:center;
  border-top:0;
  font-size:11px;
  gap:4px;
}

/* Footer table layout like the attachment */
.footer-table{
  border-top:2px solid #000000;
  border-bottom:2px solid #000000;
  width:100%;
  height:100%;
  display:table;
  border-collapse:collapse;
}

.footer-row{
  display:table-row;
  height:50%;
}

.footer-cell{
  display:table-cell;
  border:none;
  padding:0.5mm 1mm;
  font-size:10px;
  vertical-align:middle;
  text-align:left;
  width:33.33%;
  line-height:1;
}

/* Page 1 styles - logo only (centered) */
.page-logo-only .content{display:flex;align-items:center;justify-content:center}
.page-logo-only .content img{max-width:70%;max-height:70%;object-fit:contain}

/* COVER PAGE - Exact format from image */
.page-cover {
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cover-content {
  width: 100%;
  height: 100%;
  padding: 12mm 20mm;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

/* Logo at top */
.cover-logo {
  margin-bottom: 8mm;
  margin-top: 20mm;
}

.cover-logo img {
  max-width: 150mm;
  max-height: 100mm;
  object-fit: contain;
}

/* Title - "Technical Offer" */
.cover-title {
  font-size: 30px;
  font-weight: bold;
  color: #111;
  margin-bottom: 6mm;
  letter-spacing: 0.5px;
}

/* Work Type - "HVAC SYSTEM" */
.cover-work-type {
  font-size: 24px;
  font-weight: bold;
  color: #111;
  margin-bottom: 5mm;
  letter-spacing: 1px;
}

/* For */
.cover-for {
  font-size: 18px;
  font-weight: bold;
  color: #111;
  margin-bottom: 5mm;
}

/* Company Name - Bold and larger */
.cover-company {
  font-size: 27px;
  font-weight: bold;
  color: #111;
  margin-bottom: 3mm;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Address */
.cover-address {
  font-size: 15px;
  color: #222;
  margin-bottom: 10mm;
  font-style: italic;
}

/* Details Table at bottom */
.cover-details-table {
  width: 85%;
  margin: auto;
  border: 1px solid #111;
  max-height: 120mm;
  overflow: hidden;
}

.cover-details-table table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

.cover-details-table td {
  border: 1px solid #111;
  padding: 5px 8px;
  vertical-align: top;
  font-size: 14px;
  line-height: 1.5;
  text-align: left;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.cover-details-table .details-left {
  width: 48%;
  background: #fafafa;
}

.cover-details-table .details-right {
  width: 52%;
  background: #fff;
}

/* Make text in table more compact */
.cover-details-table td br {
  line-height: 1.2;
  display: block;
  content: "";
  margin: 0;
}

/* Offer details page (Page 2) */
.page-offer-details .offer-section{margin-bottom:8mm}
.page-offer-details .offer-section h2{font-size:18px;margin-bottom:4mm;color:#2c5530;border-bottom:2px solid #2c5530;padding-bottom:2mm}
.page-offer-details .offer-details{background:#f9f9f9;padding:4mm;border-left:4px solid #2c5530;border-radius:2mm}

/* Offer line items styling */
.offer-line-item{display:flex;margin-bottom:3mm;padding:2mm 0;border-bottom:1px solid #e0e0e0}
.offer-line-item:last-child{border-bottom:none;margin-bottom:0}
.offer-label{font-weight:bold;color:#2c5530;width:25%;flex-shrink:0;font-size:13px}
.offer-value{color:#333;font-size:13px;line-height:1.3;flex:1;margin-left:2mm}

.page-offer-details .project-details{display:flex;gap:6mm;height:auto}
.page-offer-details .project-left, .page-offer-details .project-right{flex:1}
.page-offer-details .project-left h3, .page-offer-details .project-right h3{font-size:14px;margin-bottom:3mm;color:#2c5530;border-bottom:1px solid #ddd;padding-bottom:2mm}
.page-offer-details .project-content{font-size:12px;line-height:1.4;white-space:pre-line}

/* Page main title styling */
.page-main-title {
  font-size: 20px;
  font-weight: bold;
  color: #2c5530;
  margin: 0 0 12px 0;
  padding-bottom: 8px;
  border-bottom: 2px solid #2c5530;
  text-align: center;
}

/* Project pages (single image full focus) */
.page-project .content {
  padding: 8mm var(--gutter);
  height: var(--content-h);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.page-project .img-block{
  flex: 1;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#ffffff;
  border:1px solid #fff;
}

.page-project .img-block img{max-width:98%;max-height:98%;object-fit:contain;}

/* Vendor page styling */
.page-vendor .content {
  padding: 8mm var(--gutter);
  height: var(--content-h);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Vendor logo block */
.page-vendor .vendor-block{
  flex: 1;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#ffffff;
  border:1px solid #ffffff;
}

.page-vendor .vendor-block img{max-width:90%;max-height:100%;object-fit:contain;}

/* BOM page styling */
.page-bom .content {
  padding: 1mm var(--gutter);
  height: var(--content-h);
  overflow: hidden;
}

.page-bom .bom-content {
  font-size: 12px;
  line-height: 1.5;
  width: 100%;
  height: 100%;
}

.page-bom .bom-content table,
.page-bom .bom-content .bom-table {
  width: 100%;
  border-collapse: collapse;
  margin: 10px auto;
  table-layout: auto;
}

.page-bom .bom-content table td,
.page-bom .bom-content table th,
.page-bom .bom-content .bom-table td,
.page-bom .bom-content .bom-table th {
  border: 1px solid #999;
  padding: 2px 6px;
  text-align: left;
  font-size: 12px;
  word-wrap: break-word;
  overflow-wrap: break-word;
  max-width: 150px;
  line-height: 1.3;
}

.page-bom .bom-content table th,
.page-bom .bom-content .bom-table th {
  background-color: #d0d0d0 !important;
  font-weight: bold !important;
  font-size: 15px !important;
  text-align: center;
  color: #000 !important;
  padding: 2px 6px !important;
}

.page-bom .bom-content thead {
  display: table-header-group !important;
  background-color: #d0d0d0 !important;
}

.page-bom .bom-content tbody {
  display: table-row-group;
}

.page-bom .bom-content table tr:nth-child(even) {
  background-color: #f9f9f9;
}

/* Clean table styling */
.clean-table{width:100%;border-collapse:collapse;font-size:11px;margin-bottom:4mm}
.clean-table th,.clean-table td{border:1px solid #bfbfbf;padding:4px 6px;vertical-align:top;word-wrap:break-word}
.clean-table thead{background:#f7f7f7;font-weight:700;display:table-header-group}
.clean-table th{font-size:10px;text-align:center;background:#e8f4fd}

/* GST section styling in PDF */
.clean-table .gst-section-pdf tr {
  background: #f9f9f9;
}

.clean-table .gst-label {
  font-weight: bold;
  text-align: right;
  padding-right: 10px;
  background: #f0f0f0;
}

.clean-table .gst-value {
  text-align: right;
  font-weight: bold;
  background: #fff;
}

.clean-table .gst-section-pdf tr:last-child .gst-label,
.clean-table .gst-section-pdf tr:last-child .gst-value {
  background: #e8f4fd;
  font-size: 12px;
  font-weight: bold;
}

/* Table page specific styling */
.page-table .content{padding:4mm var(--gutter)}
.page-table .clean-table{height:auto;max-height:100%}

/* ensure no interactive controls show */
.clean-table button,
.clean-table input,
.clean-table textarea { display:none !important; }

/* Section headers styling */
h2 {
  margin-top: 0;
  margin-bottom: 4mm;
  font-size: 16px;
  color: #2c5530;
}

/* Content spacing improvements */
.content > div:not(:last-child) {
  margin-bottom: 6mm;
}

/* Logo page improvements */
.page-logo-only .content {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

/* Footer improvements */
.footer div {
  text-align: center;
  color: #000;
}

/* Header center text styling */
.header .center {
  font-size: 16px;
  color: #2c5530;
  font-weight: bold;
}

/* Price schedule page */
.page-price-schedule .price-section h2{font-size:18px;margin-bottom:6mm;color:#2c5530;border-bottom:2px solid #2c5530;padding-bottom:2mm}
.page-price-schedule .content{overflow:auto;font-size:12px;line-height:1.45}

/* Company details page */
.page-company-details .company-section h2{font-size:18px;margin-bottom:6mm;color:#2c5530;border-bottom:2px solid #2c5530;padding-bottom:2mm}
.page-company-details .content{overflow:auto;font-size:12px;line-height:0.5}

/* Company details table styling */
.company-details-container{background:#838383;padding:0.4mm;border-radius:2mm}
.company-details-table{width:100%;border-collapse:collapse;font-size:13px;background:#fff;border-radius:2mm;overflow:hidden;}
.company-details-table td{padding:8px 12px;border:1px solid #ffffff;vertical-align:top}
.company-label{font-weight:bold;color:#2c5530;background:#ffffff;width:30%;text-align:right}
.company-colon{width:5%;text-align:center;color:#666;background:#ffffff}
.company-value{color:#333;background:#fff}

/* General page full text (fallback) */
.page-fulltext .content{overflow:auto;font-size:12px;line-height:1.45}

/* Optimize for PDF generation - reduce visual complexity */
.pdf-optimized {
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

.pdf-optimized .a4page {
  box-shadow: none !important;
  border: none !important;
}

.pdf-optimized img {
  max-width: 100%;
  height: auto;
  image-rendering: optimizeQuality;
}

/* Remove gradients and shadows for PDF to reduce file size */
.pdf-optimized .page-logo-only .content {
  background: #ffffff !important;
}

.pdf-optimized .page-project .img-block img {
  box-shadow: none !important;
}

/* print rules */
@media print{
  body{margin:0;background:transparent}
  .a4page{box-shadow:none;border:none;page-break-after:always}
  .topbar,.preview-actions{display:none}
  
  /* Remove all shadows and gradients in print */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
    background-image: none !important;
  }
}